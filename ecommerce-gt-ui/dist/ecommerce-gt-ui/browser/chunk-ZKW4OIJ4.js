import{C as u,D as v,Da as Q,F as a,G as p,H as A,I as P,J as E,K as I,L as C,M as N,N as k,Q as h,R as g,S as b,V as F,W as w,X as M,Y as $,Z as B,_ as V,aa as D,ba as G,i as y,j as S,ja as O,k as T,la as W,na as j,oa as L,p as o,r as c,ra as H,t as s,u as f,v as R,w as t,x as e,y as x}from"./chunk-TC64J5CO.js";var U=(()=>{class n{constructor(){this.http=S(G),this.base=`${W.apiBase}/admin/reportes`}topProductos(i,l,r=10){return this.http.get(`${this.base}/top-productos`,{params:{desde:i,hasta:l,limit:r}})}topClientesGanancia(i,l,r=5){return this.http.get(`${this.base}/top-clientes-ganancia`,{params:{desde:i,hasta:l,limit:r}})}topVendedores(i,l,r=5){return this.http.get(`${this.base}/top-vendedores`,{params:{desde:i,hasta:l,limit:r}})}topClientesPedidos(i,l,r=10){return this.http.get(`${this.base}/top-clientes-pedidos`,{params:{desde:i,hasta:l,limit:r}})}topInventario(i=10){return this.http.get(`${this.base}/top-inventario`,{params:{limit:i}})}notificaciones(i,l){let r=new D().set("desde",i).set("hasta",l);return this.http.get(`${this.base}/notificaciones`,{params:r})}static{this.\u0275fac=function(l){return new(l||n)}}static{this.\u0275prov=y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var z=()=>["/admin/empleados"];function J(n,d){n&1&&(t(0,"div",19),x(1,"div",20),e())}function K(n,d){if(n&1&&(t(0,"div",21),a(1),e()),n&2){let i=v();o(),p(i.error)}}function X(n,d){if(n&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),a(4),e(),t(5,"td",25),a(6),h(7,"number"),e(),t(8,"td",25),a(9),h(10,"currency"),e()()),n&2){let i=d.$implicit,l=d.index;o(2),p(l+1),o(2),p(i.nombre),o(2),p(g(7,4,i.unidadesVendidas)),o(3),p(b(10,6,i.totalVendido,"GTQ"))}}function Z(n,d){n&1&&(t(0,"tr")(1,"td",27),a(2,"Sin datos"),e()())}function ee(n,d){if(n&1&&(t(0,"div")(1,"div",22)(2,"div",23)(3,"table",24)(4,"thead")(5,"tr")(6,"th"),a(7,"#"),e(),t(8,"th"),a(9,"Producto"),e(),t(10,"th",25),a(11,"Unidades"),e(),t(12,"th",25),a(13,"Total vendido (GTQ)"),e()()(),t(14,"tbody"),c(15,X,11,9,"tr",26)(16,Z,3,0,"tr",18),e()()()()()),n&2){let i=v();o(15),s("ngForOf",i.topProductos),o(),s("ngIf",i.topProductos.length===0)}}function te(n,d){if(n&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),a(4),e(),t(5,"td",25),a(6),h(7,"currency"),e()()),n&2){let i=d.$implicit,l=d.index;o(2),p(l+1),o(2),p(i.nombre),o(2),p(b(7,3,i.totalNeto,"GTQ"))}}function ie(n,d){n&1&&(t(0,"tr")(1,"td",28),a(2,"Sin datos"),e()())}function ne(n,d){if(n&1&&(t(0,"div")(1,"div",22)(2,"div",23)(3,"table",24)(4,"thead")(5,"tr")(6,"th"),a(7,"#"),e(),t(8,"th"),a(9,"Cliente"),e(),t(10,"th",25),a(11,"Ganancia generada (95%)"),e()()(),t(12,"tbody"),c(13,te,8,6,"tr",26)(14,ie,3,0,"tr",18),e()()()()()),n&2){let i=v();o(13),s("ngForOf",i.topGanancia),o(),s("ngIf",i.topGanancia.length===0)}}function ae(n,d){if(n&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),a(4),e(),t(5,"td",25),a(6),h(7,"number"),e()()),n&2){let i=d.$implicit,l=d.index;o(2),p(l+1),o(2),p(i.nombre),o(2),p(g(7,3,i.cantidad))}}function oe(n,d){n&1&&(t(0,"tr")(1,"td",28),a(2,"Sin datos"),e()())}function re(n,d){if(n&1&&(t(0,"div")(1,"div",22)(2,"div",23)(3,"table",24)(4,"thead")(5,"tr")(6,"th"),a(7,"#"),e(),t(8,"th"),a(9,"Vendedor"),e(),t(10,"th",25),a(11,"Unidades vendidas"),e()()(),t(12,"tbody"),c(13,ae,8,5,"tr",26)(14,oe,3,0,"tr",18),e()()()()()),n&2){let i=v();o(13),s("ngForOf",i.topVendedores),o(),s("ngIf",i.topVendedores.length===0)}}function de(n,d){if(n&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),a(4),e(),t(5,"td",25),a(6),h(7,"number"),e()()),n&2){let i=d.$implicit,l=d.index;o(2),p(l+1),o(2),p(i.nombre),o(2),p(g(7,3,i.cantidad))}}function le(n,d){n&1&&(t(0,"tr")(1,"td",28),a(2,"Sin datos"),e()())}function se(n,d){if(n&1&&(t(0,"div")(1,"div",22)(2,"div",23)(3,"table",24)(4,"thead")(5,"tr")(6,"th"),a(7,"#"),e(),t(8,"th"),a(9,"Cliente"),e(),t(10,"th",25),a(11,"# Pedidos"),e()()(),t(12,"tbody"),c(13,de,8,5,"tr",26)(14,le,3,0,"tr",18),e()()()()()),n&2){let i=v();o(13),s("ngForOf",i.topPedidos),o(),s("ngIf",i.topPedidos.length===0)}}function pe(n,d){if(n&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),a(4),e(),t(5,"td",25),a(6),h(7,"number"),e()()),n&2){let i=d.$implicit,l=d.index;o(2),p(l+1),o(2),p(i.nombre),o(2),p(g(7,3,i.cantidad))}}function me(n,d){n&1&&(t(0,"tr")(1,"td",28),a(2,"Sin datos"),e()())}function ce(n,d){if(n&1&&(t(0,"div")(1,"div",22)(2,"div",23)(3,"table",24)(4,"thead")(5,"tr")(6,"th"),a(7,"#"),e(),t(8,"th"),a(9,"Vendedor"),e(),t(10,"th",25),a(11,"# Productos activos"),e()()(),t(12,"tbody"),c(13,pe,8,5,"tr",26)(14,me,3,0,"tr",18),e()()()()()),n&2){let i=v();o(13),s("ngForOf",i.topInventario),o(),s("ngIf",i.topInventario.length===0)}}function _e(n,d){n&1&&(t(0,"div",31),x(1,"div",20),e())}function ve(n,d){if(n&1&&(t(0,"tr")(1,"td"),a(2),e(),t(3,"td"),a(4),e(),t(5,"td")(6,"span",32),a(7),e()(),t(8,"td"),a(9),e(),t(10,"td"),a(11),h(12,"date"),e(),t(13,"td")(14,"span"),a(15),e()(),t(16,"td"),a(17),h(18,"date"),e()()),n&2){let i=d.$implicit;o(2),p(i.id),o(2),P("",i.usuarioNombre," (",i.usuarioId,")"),o(3),p(i.tipo),o(2),p(i.asunto),o(2),p(b(12,10,i.creadoEn,"medium")),o(3),R("badge "+(i.enviado?"bg-success":"bg-danger")),o(),A(" ",i.enviado?"S\xED":"No"," "),o(2),p(i.enviadoEn?b(18,13,i.enviadoEn,"medium"):"-")}}function he(n,d){n&1&&(t(0,"tr")(1,"td",33),a(2,"Sin registros"),e()())}function ue(n,d){if(n&1&&(t(0,"table",24)(1,"thead")(2,"tr")(3,"th"),a(4,"ID"),e(),t(5,"th"),a(6,"Usuario"),e(),t(7,"th"),a(8,"Tipo"),e(),t(9,"th"),a(10,"Asunto"),e(),t(11,"th"),a(12,"Creado"),e(),t(13,"th"),a(14,"Enviado"),e(),t(15,"th"),a(16,"Enviado en"),e()()(),t(17,"tbody"),c(18,ve,19,16,"tr",26)(19,he,3,0,"tr",18),e()()),n&2){let i=v(2);o(18),s("ngForOf",i.notisSimple),o(),s("ngIf",i.notisSimple.length===0)}}function fe(n,d){if(n&1&&(t(0,"div")(1,"div",22)(2,"div",23),c(3,_e,2,0,"div",29)(4,ue,20,2,"table",30),e()()()),n&2){let i=v();o(3),s("ngIf",i.cargandoNotis),o(),s("ngIf",!i.cargandoNotis)}}function Y(){let n=new Date,d=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0"),l=String(n.getDate()).padStart(2,"0");return`${d}-${i}-${l}`}var ke=(()=>{class n{constructor(){this.api=S(U),this.desde=Y(),this.hasta=Y(),this.tab="productos",this.topProductos=[],this.topGanancia=[],this.topVendedores=[],this.topPedidos=[],this.topInventario=[],this.notisSimple=[],this.cargandoNotisSimple=!1,this.n_desde="",this.n_hasta="",this.n_tipo="",this.n_pagina=0,this.n_tamanio=20,this.cargandoNotis=!1,this.cargando=!1,this.error=""}ngOnInit(){this.cargarTodo()}setTab(i){this.tab=i}cargarTodo(){this.cargando=!0,this.error="",Promise.all([this.api.topProductos(this.desde,this.hasta,10).toPromise(),this.api.topClientesGanancia(this.desde,this.hasta,5).toPromise(),this.api.topVendedores(this.desde,this.hasta,5).toPromise(),this.api.topClientesPedidos(this.desde,this.hasta,10).toPromise(),this.api.topInventario(10).toPromise(),this.cargarNotificacionesSimple()]).then(([i,l,r,m,_])=>{this.topProductos=i??[],this.topGanancia=l??[],this.topVendedores=r??[],this.topPedidos=m??[],this.topInventario=_??[]}).catch(i=>{this.error="No se pudieron cargar los reportes."}).finally(()=>this.cargando=!1)}cargarNotificacionesSimple(){this.cargandoNotisSimple=!0,this.api.notificaciones(this.desde,this.hasta).subscribe({next:i=>{this.notisSimple=i??[],this.cargandoNotisSimple=!1},error:i=>{this.cargandoNotisSimple=!1}})}limpiarNotis(){this.n_desde="",this.n_hasta="",this.n_usuarioId=void 0,this.n_tipo="",this.cargarNotificacionesSimple()}onTabNotis(){this.setTab("notis"),this.n_page||this.cargarNotificacionesSimple()}static{this.\u0275fac=function(l){return new(l||n)}}static{this.\u0275cmp=T({type:n,selectors:[["app-admin-reportes"]],standalone:!0,features:[N],decls:49,vars:24,consts:[[1,"container","py-4"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"m-0"],[1,"bi","bi-graph-up-arrow","me-2"],[1,"btn","btn-outline-secondary","btn-sm","fw-semibold",3,"routerLink"],[1,"bi","bi-arrow-left-circle","me-1"],[1,"card","mb-3"],[1,"card-body","row","g-2","align-items-end"],[1,"col-md-3"],[1,"form-label"],["type","date",1,"form-control",3,"ngModelChange","ngModel"],[1,"btn","btn-primary","mt-3",3,"click"],[1,"bi","bi-funnel","me-1"],["class","col-md-3 text-end",4,"ngIf"],["class","text-danger small",4,"ngIf"],[1,"nav","nav-pills","mb-3"],[1,"nav-item"],[1,"nav-link",3,"click"],[4,"ngIf"],[1,"col-md-3","text-end"],[1,"spinner-border"],[1,"text-danger","small"],[1,"card"],[1,"card-body","table-responsive"],[1,"table","table-hover","align-middle"],[1,"text-end"],[4,"ngFor","ngForOf"],["colspan","4",1,"text-center","text-muted"],["colspan","3",1,"text-center","text-muted"],["class","text-center py-4",4,"ngIf"],["class","table table-hover align-middle",4,"ngIf"],[1,"text-center","py-4"],[1,"badge","bg-secondary"],["colspan","7",1,"text-center","text-muted"]],template:function(l,r){l&1&&(t(0,"div",0)(1,"div",1)(2,"h4",2),x(3,"i",3),a(4," Reportes del Administrador "),e(),t(5,"a",4),x(6,"i",5),a(7," Regresar "),e()(),t(8,"div",6)(9,"div",7)(10,"div",8)(11,"label",9),a(12,"Desde"),e(),t(13,"input",10),C("ngModelChange",function(_){return I(r.desde,_)||(r.desde=_),_}),e()(),t(14,"div",8)(15,"label",9),a(16,"Hasta"),e(),t(17,"input",10),C("ngModelChange",function(_){return I(r.hasta,_)||(r.hasta=_),_}),e()(),t(18,"div",8)(19,"button",11),u("click",function(){return r.cargarTodo()}),x(20,"i",12),a(21,"Filtrar "),e()(),c(22,J,2,0,"div",13)(23,K,2,1,"div",14),e()(),t(24,"ul",15)(25,"li",16)(26,"button",17),u("click",function(){return r.setTab("productos")}),a(27,"Top 10 productos"),e()(),t(28,"li",16)(29,"button",17),u("click",function(){return r.setTab("ganancia")}),a(30,"Top 5 clientes por ganancia"),e()(),t(31,"li",16)(32,"button",17),u("click",function(){return r.setTab("vendedores")}),a(33,"Top 5 vendedores (unidades)"),e()(),t(34,"li",16)(35,"button",17),u("click",function(){return r.setTab("pedidos")}),a(36,"Top 10 clientes por pedidos"),e()(),t(37,"li",16)(38,"button",17),u("click",function(){return r.setTab("inventario")}),a(39,"Top 10 prod. en venta"),e()(),t(40,"li",16)(41,"button",17),u("click",function(){return r.onTabNotis()}),a(42," Historial de notificaciones "),e()()(),c(43,ee,17,2,"div",18)(44,ne,15,2,"div",18)(45,re,15,2,"div",18)(46,se,15,2,"div",18)(47,ce,15,2,"div",18)(48,fe,5,2,"div",18),e()),l&2&&(o(5),s("routerLink",k(23,z)),o(8),E("ngModel",r.desde),o(4),E("ngModel",r.hasta),o(5),s("ngIf",r.cargando),o(),s("ngIf",r.error),o(3),f("active",r.tab==="productos"),o(3),f("active",r.tab==="ganancia"),o(3),f("active",r.tab==="vendedores"),o(3),f("active",r.tab==="pedidos"),o(3),f("active",r.tab==="inventario"),o(3),f("active",r.tab==="notis"),o(2),s("ngIf",r.tab==="productos"),o(),s("ngIf",r.tab==="ganancia"),o(),s("ngIf",r.tab==="vendedores"),o(),s("ngIf",r.tab==="pedidos"),o(),s("ngIf",r.tab==="inventario"),o(),s("ngIf",r.tab==="notis"))},dependencies:[V,F,w,$,B,M,Q,j,L,H,O],encapsulation:2})}}return n})();export{ke as AdminReportesComponent};
